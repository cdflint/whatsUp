{"version":3,"sources":["webpack:///webpack/bootstrap fcad7b61aafd76c252ea","webpack:///./public/js/event/index/index.js","webpack:///./public/js/event/index/router/main.js","webpack:///./public/js/event/index/view/map.js","webpack:///./public/js/shared/view/map.js","webpack:///./public/js/map/leafletViewer.js","webpack:///./public/js/util/class.js","webpack:///./public/js/map/mapViewer.js","webpack:///./public/js/event/index/view/calendar.js","webpack:///./public/js/event/index/controller/main.js"],"names":["MainRouter","require","$","router","Backbone","history","start","console","log","MainController","controller","mainRouter","Router","extend","name","routes","init","initialize","initZoom","x","y","zoomToLocation","module","exports","BaseMap","map","el","mapData","render","scope","makeMap","onMapLoaded","LeafletViewer","View","type","mapControlsTemplate","mapDataLoaded","selectedLayer","selectedFeature","selectedFeatureName","selectedLayers","singleSelect","mapParams","areatype","areacode","showMarkers","clusterMarkerCache","options","loadMapData","renderControls","mapViewer","center","L","LatLng","zoomLevel","scrollZoom","clusterOptions","showCoverageOnHover","spiderfyOnMaxZoom","maxClusterRadius","iconCreateFunction","cluster","childCount","getChildCount","c","DivIcon","html","className","iconSize","Point","model","Model","counter","loadData","layer","url","fetch","success","data","newData","toJSON","length","showLayer","setInitialAreaType","getLayer","title","getGeomName","updateHoverText","nameField","layerStyle","style","mouseoverStyle","fillOpacity","selectedStyle","opacity","color","weight","clearGeoJsonFeatures","addGeoJsonLayer","onEachFeature","feature","properties","on","e","layerGroup","getGeoJsonGroup","_","each","getLayers","layers","l","resetStyle","target","index","i","splice","push","sl","region","areacodes","params","setStyle","props","join","onGeomSelected","call","Browser","ie","opera","bringToFront","prop","area","text","onFeatureMouseover","onFeatureMouseout","template","Handlebars","compile","models","mapControlClick","append","after","zoomToGeoJsonFeatures","currentTarget","attr","parent","find","remove","onLayerChanged","getCurrentParams","selectGeom","featureNames","selectStyle","geoJsonGrp","f","eachLayer","toLowerCase","addClusterMarkers","clearClusterMarkers","d","m","createMarker","y_coord","x_coord","bindPopup","addClusterMarker","setShowMarkers","value","lon","lat","zoomToPoint","setMapClickMode","mode","Class","MapViewer","define","_className","prototype","apply","arguments","minimal","tileLayer","baseMaps","features","FeatureGroup","geoJsonFeatures","geoJson","clusterGroup","MarkerClusterGroup","overlayMaps","zoom","scrollWheelZoom","baseLayers","undefined","overlays","getFeatureGroup","option","addLayer","clearLayers","addFeatureToFeatureGroup","clearFeatures","createFeature","obj","wkt","Wkt","read","toObject","lng","marker","latLng","getClusterGroup","getFeaturesBound","getBounds","getGeoJsonFeaturesBound","zoomToFeatures","bounds","fitBounds","point","z","getMaxZoom","latlng","setView","pointInPolygon","vs","inside","j","xi","yi","xj","yj","intersect","child","ch","p","_class_","copy","F","constructor","dest","source","property","sourceIsEvt","window","Event","hasOwnProperty","toString","zoomToExtent","extent","LatLngBounds","xmin","ymin","xmax","ymax","zoomToFullExtent","zoomToXY","level","zoomIn","zoomOut","zoomToDataExtent","panTo","locate","locateAndSetView","Calendar","fullCalendar","header","left","right","editable","eventSources","eventLimit","eventClick","event","jsEvent","view","onEventClick","loading","isLoading","eventData","onEventsLoaded","MapView","CalendarView","mainController","_mapView","_calendarView"],"mappings":"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","file":"eventIndex-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fcad7b61aafd76c252ea","/*\r\nTu Hoang\t\r\nESRGC2017\r\n\r\nmap view package\r\n\r\n*/\r\n\r\nvar MainRouter = require('./router/main.js');\r\n\r\n$(() => {\r\n  var router = new MainRouter();\r\n  //finally starts backbone history;\r\n  Backbone.history.start();\r\n  console.log('App initiated...')\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./public/js/event/index/index.js","/*\r\nTu Hoang\r\nMarch 2017\r\n\r\nmain router for event/index page\r\n*/\r\n\r\n// var MapView = require('../view/map.js');\r\n// var CalendarView = require('../view/calendar');\r\n\r\n// //views\r\n// var mapView = new MapView();\r\n// var calendarView = new CalendarView();\r\n\r\nvar MainController = require('../controller/main');\r\nvar controller = new MainController();\r\n\r\n//router definition\r\nvar mainRouter = Backbone.Router.extend({\r\n  name: 'EventIndex',\r\n  routes: {\r\n    '': 'init',\r\n    ':x/:y': 'initZoom'\r\n  },\r\n  init: () => {\r\n    console.log('Initializing...')\r\n    //initialize components\r\n    controller.initialize();\r\n\r\n    //return controller;\r\n  },\r\n  initZoom: (x, y) => {\r\n    this.init();\r\n    controller.zoomToLocation(x, y);\r\n  }\r\n});\r\n\r\nmodule.exports = mainRouter;\r\n\n\n\n// WEBPACK FOOTER //\n// ./public/js/event/index/router/main.js","/*\r\nAuthor: Tu Hoang\r\nESRGC2017\r\n\r\nView Map\r\n\r\n\r\nRequires leaflet.js\r\n\r\nEvents \r\nonMapLoaded --fired when map is done initialized\r\nonLayerChanged -- fired when new data is loaded to geojson\r\nonGeomSelected -- fired when mouse clicked layer (geometry)\r\nonFeatureMouseover -- fired when mouse is over a layer (geometry)\r\nonFeatureMouseout -- fired when mouse is out of a layer (geometry)\r\n\r\nsetMapClickMode -- set selection mode (single or multi)\r\n*/\r\nvar BaseMap = require('../../../shared/view/map.js');\r\n\r\nvar map = BaseMap.extend({\r\n  name: 'unite-map',\r\n  el: '.map',\r\n  mapData: [\r\n\r\n  ], //specified geojson layers (in sub views)\r\n  render: function() {\r\n    var scope = this;\r\n    scope.makeMap(); //set up map\r\n    if (typeof scope.onMapLoaded == 'function') {\r\n      scope.onMapLoaded();\r\n    }\r\n  }\r\n});\r\n\r\nmodule.exports = map;\r\n\n\n\n// WEBPACK FOOTER //\n// ./public/js/event/index/view/map.js","/*\r\nAuthor: Tu Hoang\r\nESRGC2017\r\n\r\nView Map\r\nbase map view using backbone.js\r\nelement: '.map'\r\nrender basic map for dashboards\r\n\r\nRequires leaflet.js\r\n\r\nEvents \r\nonMapLoaded --fired when map is done initialized\r\nonLayerChanged -- fired when new data is loaded to geojson\r\nonGeomSelected -- fired when mouse clicked layer (geometry)\r\nonFeatureMouseover -- fired when mouse is over a layer (geometry)\r\nonFeatureMouseout -- fired when mouse is out of a layer (geometry)\r\n\r\nsetMapClickMode -- set selection mode (single or multi)\r\n*/\r\nvar LeafletViewer = require('../../map/leafletViewer');\r\n\r\nvar map = Backbone.View.extend({\r\n  name: 'base-map',\r\n  el: '.map',\r\n  type: 'map',\r\n  mapControlsTemplate: '#map-control-tpl',\r\n  mapData: [\r\n    //defined in sub-classes\r\n    // For example\r\n    // {\r\n    //   name: 'Region',\r\n    //   type: 'layer',\r\n    //   label: '',\r\n    //   url: 'data/mdRegion.geojson',\r\n    //   nameField: 'Regions',\r\n    //   style: {\r\n    //     fill: true,\r\n    //     weight: 1,\r\n    //     fillOpacity: 0.1,\r\n    //     fillColor: '#2163B5',\r\n    //     color: '#000'\r\n    //   },\r\n    //   selected: true\r\n    // }\r\n  ], //specified geojson layers (in sub views)\r\n  mapDataLoaded: false,\r\n  selectedLayer: 'County', //geometry type \"County\" or \"Region\"\r\n  selectedFeature: null,\r\n  selectedFeatureName: '',\r\n  selectedLayers: [],\r\n  singleSelect: false,\r\n  mapParams: {\r\n    areatype: '01',\r\n    areacode: '0'\r\n  },\r\n  showMarkers: true,\r\n  clusterMarkerCache: [],\r\n  initialize: function() {\r\n    //this.render();\r\n  },\r\n  render: function(options) {\r\n    this.makeMap(); //set up map\r\n    this.loadMapData(options); //load geometry       \r\n    this.renderControls(); //render layer controls\r\n    console.log(this.name + ' view has been rendered..')\r\n  },\r\n  makeMap: function() {\r\n    this.mapViewer = new LeafletViewer({\r\n      el: this.el,\r\n      center: new L.LatLng( 38.3607, -75.5994 ), //salisbury coordinates\r\n      zoomLevel: 10,\r\n      scrollZoom: true,\r\n      clusterOptions: {\r\n        showCoverageOnHover: false,\r\n        spiderfyOnMaxZoom: true,\r\n        maxClusterRadius: 40,\r\n        iconCreateFunction: function(cluster) {\r\n          var childCount = cluster.getChildCount();\r\n          var c = ' marker-cluster-';\r\n          if (childCount <= 5) {\r\n            c += 'small';\r\n          } else if (childCount <= 10) {\r\n            c += 'medium';\r\n          } else {\r\n            c += 'large';\r\n          }\r\n\r\n          return new L.DivIcon({\r\n            html: '<div><span>' + childCount + '</span></div>',\r\n            className: 'marker-cluster' + c,\r\n            iconSize: new L.Point(40, 40)\r\n          });\r\n        }\r\n      }\r\n    });\r\n  },\r\n  loadMapData: function(options) {\r\n    var scope = this;\r\n    //use backbone model to load layer data\r\n    var model = new Backbone.Model();\r\n    var mapData = this.mapData;\r\n    var counter = 0;\r\n    var loadData = function(layer) {\r\n      if (typeof layer == 'undefined'){\r\n        if (typeof scope.onMapLoaded == 'function') {\r\n          scope.onMapLoaded();\r\n        }\r\n        return;\r\n      }\r\n      if (layer.type == 'layer') {\r\n        model.url = layer.url;\r\n        model.fetch({\r\n          success: function(data) {\r\n            console.log('loaded map data for ' + layer.name);\r\n            var newData = data.toJSON();\r\n            layer.data = newData;\r\n            //move to the next one\r\n            counter++;\r\n            if (counter < mapData.length) { //load more if exists\r\n              loadData(mapData[counter]);\r\n            } else {\r\n\r\n              scope.mapDataLoaded = true;\r\n              //show the state layer by default\r\n              scope.showLayer(scope.selectedLayer, options);\r\n              // scope.updateCharts(); //initially load charts data\r\n\r\n              if (typeof scope.onMapLoaded == 'function') {\r\n                scope.onMapLoaded();\r\n              }\r\n            }\r\n          }\r\n        });\r\n      } else { //if data is not a layer skip to the next one\r\n        counter++;\r\n        if (counter < mapData.length) { //load more if exists\r\n          this.loadData(mapData[counter]);\r\n        } else {\r\n\r\n          scope.mapDataLoaded = true;\r\n          //show the state layer by default\r\n          scope.showLayer(scope.selectedLayer, options);\r\n          // scope.updateCharts(); //initially load charts data\r\n\r\n          if (typeof scope.onMapLoaded == 'function') {\r\n            scope.onMapLoaded();\r\n          }\r\n        }\r\n      }\r\n    };\r\n    loadData(mapData[counter]);\r\n  },\r\n  //clear geometry and add the layer that is being requested to show\r\n  showLayer: function(name, options) {\r\n    console.log(\"showing  layer \" + name);\r\n    var scope = this;\r\n    var setInitialAreaType = false;\r\n    var layer = this.getLayer(name);\r\n    if (typeof layer == 'undefined')\r\n      return;\r\n    scope.selectedLayer = name;\r\n    scope.selectedFeatureName = '';\r\n    scope.selectedFeature = null;\r\n    scope.selectedLayers = [];\r\n    var title = scope.getGeomName();\r\n    scope.updateHoverText();\r\n    var mapViewer = this.mapViewer;\r\n    var newData = layer.data;\r\n    var nameField = layer.nameField; //name of the property that contains geom name\r\n\r\n    //determine layer styles (either a function returning style or a style object)\r\n    var layerStyle = layer.style;\r\n    var mouseoverStyle = {\r\n      fillOpacity: 0.2\r\n    };\r\n    var selectedStyle = layer.selectedStyle || {\r\n      //fillOpacity: 0.5\r\n      //dashArray: '',\r\n      opacity: 1,\r\n      color: '#FCFF00',\r\n      //color: '#E2E600',\r\n      weight: 4\r\n    };\r\n    console.log(options); //custom styles passed in options --this will bypass default style and styled specified in layer data\r\n    if (typeof options != 'undefined') {\r\n      if (options.style)\r\n        layerStyle = options.style; //using function or style object\r\n      if (options.mouseoverStyle)\r\n        mouseoverStyle = options.mouseoverStyle;\r\n      if (options.selectedStyle)\r\n        selectedStyle = options.selectedStyle;\r\n    }\r\n\r\n\r\n    mapViewer.clearGeoJsonFeatures(); //clear old features\r\n    mapViewer.addGeoJsonLayer(newData, {\r\n      style: layerStyle,\r\n      //this call back handles mouse events on feature selection\r\n      onEachFeature: function(feature, layer) {\r\n\r\n        //set initial areatype once layer is loaded\r\n        if (!setInitialAreaType) {\r\n          setInitialAreaType = true;\r\n          scope.mapParams.areatype = feature.properties.areatype;\r\n        }\r\n        //console.log(feature);\r\n        layer.on('click', function(e) {\r\n          //console.log(e.target);\r\n          //clear style (selected)       \r\n          var layerGroup = mapViewer.getGeoJsonGroup();\r\n          //console.log(e.target);\r\n          //reset style for the whole layer group\r\n          _.each(layerGroup.getLayers(), function(layers) {\r\n            _.each(layers.getLayers(), function(l) {\r\n              layers.resetStyle(l);\r\n            });\r\n          });\r\n          //process selected feature\r\n          var l = e.target; //get selected feature\r\n          var index = null;\r\n          //check whether the layer is currently selected\r\n          for (var i = 0; i < scope.selectedLayers.length; i++) {\r\n            var layer = scope.selectedLayers[i];\r\n            if (l.feature.properties.areacode == layer.feature.properties.areacode) {\r\n              index = i;\r\n            }\r\n          }\r\n          //simulate toggle selection\r\n          if (index != null) {\r\n            scope.selectedLayers.splice(index, 1); //remove current layer from selected\r\n          } else {\r\n            if (scope.singleSelect == true)\r\n              scope.selectedLayers = []; //reset selected layers when single select mode is on\r\n            // scope.selectedFeature = l;\r\n            scope.selectedLayers.push(l); //add selected layer to the collection\r\n          }\r\n\r\n          //set the last selected layer\r\n          if (scope.selectedLayers.length > 0) {\r\n            var sl = scope.selectedLayers[scope.selectedLayers.length - 1];\r\n            scope.selectedFeature = sl;\r\n            scope.selectedFeatureName = sl.feature.properties.name ||\r\n              sl.feature.properties.region ||\r\n              sl.feature.properties[nameField] || ''; //store selected feature name                                     \r\n          } else\r\n\r\n            scope.selectedFeature = null;\r\n\r\n          //map updates\r\n          var areatype = null,\r\n            areacodes = [],\r\n            params;\r\n\r\n          //re-hilight the selected features\r\n          _.each(scope.selectedLayers, function(sl) {\r\n            sl.setStyle(selectedStyle);\r\n            var props = sl.feature.properties;\r\n            //access properties to get area type and code            \r\n            if (typeof props.areatype != 'undefined' && typeof props.areacode != 'undefined') {\r\n              //get areatype\r\n              if (areatype == null)\r\n                areatype = props.areatype; //only set once\r\n\r\n              //get area code\r\n              areacodes.push(props.areacode);\r\n            }\r\n          });\r\n          if (areacodes.length > 0)\r\n            params = {\r\n              areatype: areatype,\r\n              areacode: areacodes.join(',')\r\n            };\r\n          else\r\n            params = {\r\n              areatype: areatype,\r\n              areacode: '0'\r\n            };\r\n          //update charts\r\n          // scope.updateCharts(params);\r\n          scope.mapParams = params;\r\n\r\n          //finally run geom selected call back \r\n          if (typeof scope.onGeomSelected == 'function') {\r\n            scope.onGeomSelected.call(scope, feature, scope.selectedLayers); //pass selected feature as an argument\r\n          }\r\n        });\r\n        layer.on('mouseover', function(e) {\r\n          //set selected style\r\n          var layer = e.target;\r\n          layer.setStyle(mouseoverStyle);\r\n\r\n          if (!L.Browser.ie && !L.Browser.opera) {\r\n            layer.bringToFront();\r\n          }\r\n\r\n          //show text on the hover box\r\n          var prop = e.target.feature.properties;\r\n          var area = prop.name || prop.region || prop[nameField] || '';\r\n          //settext\r\n          scope.$('#hoverOverlay').text(area)\r\n\r\n          if (typeof scope.onFeatureMouseover == 'function')\r\n            scope.onFeatureMouseover(layer);\r\n        });\r\n        layer.on('mouseout', function(e) {\r\n          var layerGroup = mapViewer.getGeoJsonGroup();\r\n          //console.log(e.target);\r\n          //reset style for current target\r\n          _.each(layerGroup.getLayers(), function(l) {\r\n            l.resetStyle(e.target);\r\n          });\r\n\r\n          //re-hilight the selected features\r\n          _.each(scope.selectedLayers, function(l) {\r\n            l.setStyle(selectedStyle);\r\n          });\r\n          //show text on the hover box\r\n          scope.updateHoverText();\r\n          if (typeof scope.onFeatureMouseout == 'function')\r\n            scope.onFeatureMouseout(layer);\r\n        });\r\n      }\r\n    });\r\n  },\r\n  getLayer: function(name) {\r\n    for (var i in this.mapData) {\r\n      var layer = this.mapData[i];\r\n\r\n      if (layer.name == name)\r\n        return layer;\r\n    }\r\n  },\r\n  renderControls: function() {\r\n    var scope = this;\r\n    var data = this.mapData;\r\n    // console.log(data);\r\n    var template = Handlebars.compile($(this.mapControlsTemplate).html());\r\n    var html = template({\r\n      models: data\r\n    });\r\n    this.$('div.leaflet-bottom.leaflet-left').html(html);\r\n    //wire layer controls events\r\n    this.$('.overlays div.layers').on('click', function(e) {\r\n      scope.mapControlClick.call(scope, e); //call callback in this view context\r\n    });\r\n    //hover box\r\n    this.$('div.leaflet-top.leaflet-right').append(\r\n      '<div id=\"hoverOverlay\" class=\"layerToggle\" style=\"display: block;\"></div>'\r\n    );\r\n    //zoom to extent - insert the zoom to extent button to the 2 zoom in/out buttons\r\n    this.$('div.leaflet-top.leaflet-left .leaflet-control-zoom-in').after([\r\n      ' <a class=\"leaflet-control-zoom-out\" id=\"zoomToExtent\"',\r\n      ' href=\"#\" title=\"Zoom to Full-extent\">',\r\n      '<i class=\"fa fa-globe\"></i>',\r\n      '</a>'\r\n    ].join(''));\r\n    //zoom to extent button\r\n    this.$('#zoomToExtent').on('click', function(e) {\r\n      scope.mapViewer.zoomToGeoJsonFeatures(); //zoom to extent of current geojson layer\r\n      return false;\r\n    });\r\n  },\r\n  mapControlClick: function(e) {\r\n    var c = e.currentTarget;\r\n    var name = $(c).attr('data-name');\r\n    console.log('map layer ' + name + ' control clicked');\r\n    //show layer on the map\r\n    this.showLayer(name);\r\n    //add/remove check sign\r\n    this.$(c).parent().find('i[role=\"checkbox\"]').remove();\r\n    $(c).find('p').append('<i class=\"fa fa-check\" role=\"checkbox\"></i>')\r\n      // this.updateCharts(); //load defaults.\r\n    if (typeof this.onLayerChanged == 'function')\r\n      this.onLayerChanged.call(this, name);\r\n  },\r\n  getGeomName: function() {\r\n    var title = '';\r\n    if (this.selectedLayers.length > 1) {\r\n      title = 'Multi Areas';\r\n    } else if (this.selectedFeature == null)\r\n      title = 'Statewide';\r\n    else\r\n      title = this.selectedLayer + ' ' + this.selectedFeatureName;\r\n    return title;\r\n\r\n    // switch (this.selectedLayer) {\r\n    //   case 'State':\r\n    //     title = 'Statewide'\r\n    //     break;\r\n    //   case 'County':\r\n    //     if (this.selectedLayers.length > 1) {\r\n    //       title = 'Multi counties';\r\n    //       break;\r\n    //     }\r\n    //     if (this.selectedFeature == null)\r\n    //       title = 'All counties';\r\n    //     else\r\n    //       title = 'County: ' + this.selectedFeatureName;\r\n    //     break;\r\n    //   case 'Region':\r\n    //   case 'WIA':\r\n    //     if (this.selectedLayers.length > 1) {\r\n    //       title = 'Multi areas';\r\n    //       break;\r\n    //     }\r\n    //     if (this.selectedFeature == null)\r\n    //       title = 'All areas';\r\n    //     else\r\n    //       title = 'Area: ' + this.selectedFeatureName;\r\n    //     break;\r\n    //   case 'Zip':\r\n    //     if (this.selectedFeature == null)\r\n    //       title = 'All zips';\r\n    //     else\r\n    //       title = 'Zip: ' + this.selectedFeatureName;\r\n    //     break;\r\n    // }\r\n    return title;\r\n  },\r\n  updateHoverText: function() {\r\n    var title = this.getGeomName();\r\n    //show text on the hover box\r\n    this.$('#hoverOverlay').text(title);\r\n  },\r\n  getCurrentParams: function() {\r\n    var scope = this,\r\n      areatype = null,\r\n      areacodes = [];\r\n\r\n    _.each(scope.selectedLayers, function(sl) {\r\n      var props = sl.feature.properties;\r\n      //access properties to get area type and code            \r\n      if (typeof props.areatype != 'undefined' && typeof props.areacode != 'undefined') {\r\n        //get areatype\r\n        if (areatype == null)\r\n          areatype = props.areatype; //only set once\r\n\r\n        //get area code\r\n        areacodes.push(props.areacode);\r\n      }\r\n    });\r\n    if (areacodes.length > 0)\r\n      return {\r\n        areatype: areatype,\r\n        areacode: areacodes.join(',')\r\n      };\r\n    else\r\n      return {\r\n        areatype: areatype,\r\n        areacode: '0'\r\n      };\r\n  },\r\n  //select geometry by name\r\n  selectGeom: function(featureNames, selectStyle) {\r\n    var scope = this;\r\n    var mapViewer = this.mapViewer;\r\n    var geoJsonGrp = mapViewer.getGeoJsonGroup();\r\n\r\n    var style = selectStyle || {\r\n      fillOpacity: .5\r\n    };\r\n\r\n    _.each(featureNames, function(f) {\r\n      //loop through featureNames to find the selected geom\r\n      var feature = null;\r\n      //console.log(geoJsonGrp);\r\n      geoJsonGrp.getLayers()[0].eachLayer(function(layer) {\r\n        feature = layer.feature;\r\n        if (typeof feature != 'undefined') {\r\n          //console.log(feature);\r\n          if (feature.properties.name.toLowerCase() == f.toLowerCase()) {\r\n            //found the feature, now select it\r\n            layer.setStyle(style);\r\n            //keep up with last selected feature\r\n            scope.selectedFeature = layer;\r\n            scope.selectedFeatureName = f;\r\n            scope.selectedLayers.push(layer);\r\n          }\r\n        }\r\n      });\r\n      //show text on the hover box\r\n      scope.updateHoverText();\r\n      //select fetures with the attributes specified..to be implemented\r\n      if (typeof this.onGeomSelected == 'function')\r\n        this.onGeomSelected.call(this, feature);\r\n    });\r\n  },\r\n  addClusterMarkers: function(data) {\r\n    var mapViewer = this.mapViewer;\r\n    mapViewer.clearClusterMarkers(); //clear current clustermakers\r\n    if (typeof data == 'undefined')\r\n      data = this.clusterMarkerCache;\r\n    else\r\n      this.clusterMarkerCache = data;\r\n\r\n    if (data.length == 0) {\r\n      console.log('Can not add cluster markers. Data is empty.');\r\n      return;\r\n    }\r\n    //check switch value\r\n    if (!this.showMarkers)\r\n      return;\r\n\r\n\r\n    //add new cluster markers\r\n    _.each(data, function(d) {\r\n      var m = mapViewer.createMarker(d.y_coord, d.x_coord, {});\r\n      m.bindPopup([\r\n        //to be filled out\r\n      ].join(''), {});\r\n      mapViewer.addClusterMarker(m);\r\n    });\r\n\r\n  },\r\n  clearClusterMarkers: function() {\r\n    var mapViewer = this.mapViewer;\r\n    mapViewer.clearClusterMarkers(); //clear current clustermakers\r\n  },\r\n  setShowMarkers: function(value) {\r\n    this.showMarkers = value;\r\n    if (!value)\r\n      this.clearClusterMarkers();\r\n    else\r\n      this.addClusterMarkers(); //passing no param to add the cached marker data\r\n  },\r\n  zoomToLocation: function(lon, lat) {\r\n    this.mapViewer.zoomToPoint({\r\n      x: lon,\r\n      y: lat\r\n    }, 14);\r\n  },\r\n  setMapClickMode: function(mode) {\r\n    if (mode == 'single')\r\n      this.singleSelect = true;\r\n    else if (mode == 'multi')\r\n      this.singleSelect = false;\r\n    else {\r\n      if (this.singleSelect)\r\n        console.log('Map click mode is: Single selection');\r\n      else\r\n        console.log('Map click mode is: Multi selection')\r\n    }\r\n  }\r\n});\r\n\r\nmodule.exports = map;\r\n\n\n\n// WEBPACK FOOTER //\n// ./public/js/shared/view/map.js","/*\r\nAuthor: Tu hoang\r\nESRGC\r\nProvides base (prototype) functions for mapviewer\r\nNote: this class is defined using dx library\r\n\r\nimplements leaflet API \r\noperates foodshed application\r\n*/\r\nvar Class = require('../util/class');\r\nvar MapViewer = require('./mapViewer');\r\n\r\nvar LeafletViewer = Class.define({\r\n  name: 'LeafletViewer',\r\n  extend: MapViewer,\r\n  _className: 'LeafletViewer',\r\n  initialize: function(options) {\r\n    MapViewer.prototype.initialize.apply(this, arguments);\r\n    //map setup\r\n    var minimal = L.tileLayer('http://{s}.tiles.mapbox.com/v3/esrgc.map-y9awf40v/{z}/{x}/{y}.png');\r\n    //var satellite = L.tileLayer('http://{s}.tiles.mapbox.com/v3/esrgc.map-0y6ifl91/{z}/{x}/{y}.png');\r\n\r\n    var baseMaps = {\r\n      \"Base Map\": minimal\r\n        //\"Satellite\": satellite\r\n    }\r\n    this.features = new L.FeatureGroup([\r\n      //new L.Marker([39.0, -76.70]).bindPopup('Some organization'),\r\n      //new L.Marker([39.0, -76.20]).bindPopup('Abc company'),\r\n      //new L.Marker([38.9, -76.0]).bindPopup('Eastern shore company'),\r\n      //new L.Marker([38.36, -75.59]).bindPopup('Salisbury University')\r\n    ]);\r\n    this.geoJsonFeatures = L.geoJson();\r\n    this.clusterGroup = new L.MarkerClusterGroup(this.clusterOptions);\r\n\r\n    var overlayMaps = {\r\n      //'State': stateBoundary,\r\n      //'Counties': counties,\r\n      'Overlays': this.geoJsonFeatures\r\n\r\n    }\r\n    this.map = L.map(this.el, {\r\n      layers: [\r\n        minimal,\r\n        this.features,\r\n        this.geoJsonFeatures,\r\n        this.clusterGroup\r\n      ],\r\n      center: this.center || new L.LatLng(39.0, -76.70),\r\n      zoom: this.zoomLevel || 7,\r\n      scrollWheelZoom: this.scrollZoom || false\r\n    });\r\n\r\n\r\n    //copy layers to layer controls\r\n    if (typeof this.baseLayers != 'undefined')\r\n      for (var i in this.baseLayers) {\r\n        var layer = this.baseLayers[i];\r\n        if (layer !== undefined)\r\n          baseMaps[i] = layer;\r\n      }\r\n    var overlayMaps = {\r\n      //other overlay layers go here\r\n      //feature layer\r\n      //'Features': this.features,\r\n      'Overlays': this.geoJsonFeatures\r\n    };\r\n    if (typeof this.overlays != 'undefined') {\r\n      for (var i in this.overlays) {\r\n        var layer = this.overlays[i];\r\n        overlayMaps[i] = layer;\r\n      }\r\n    }\r\n    //L.control.layers(baseMaps, overlayMaps).addTo(this.map);\r\n    //L.control.scale().addTo(this.map);\r\n  },\r\n  getGeoJsonGroup: function() {\r\n    return this.geoJsonFeatures;\r\n  },\r\n  getFeatureGroup: function() {\r\n    return this.features;\r\n  },\r\n  addGeoJsonLayer: function(data, option) {\r\n    if (typeof data == 'undefined') {\r\n      console.log('No data found')\r\n      return;\r\n    }\r\n    console.log('Adding data to map...');\r\n    //console.log(data);\r\n    if (this.geoJsonFeatures != 'undefined') {\r\n      if (typeof option == 'undefined')\r\n        this.geoJsonFeatures.addLayer(L.geoJson(data));\r\n      else\r\n        this.geoJsonFeatures.addLayer(L.geoJson(data, option));\r\n    }\r\n    console.log('------Data added to map');\r\n  },\r\n  clearGeoJsonFeatures: function() {\r\n    if (this.geoJsonFeatures != 'undefined')\r\n      this.geoJsonFeatures.clearLayers();\r\n  },\r\n  addFeatureToFeatureGroup: function(feature) {\r\n    var features = this.features;\r\n    if (typeof features == 'undefined') {\r\n      console.log('No feature group found');\r\n      return;\r\n    }\r\n    if (feature != null)\r\n      features.addLayer(feature);\r\n  },\r\n  clearFeatures: function() {\r\n    var features = this.features;\r\n    if (typeof features == 'undefined') {\r\n      console.log('No feature group found');\r\n      return;\r\n    }\r\n    features.clearLayers();\r\n  },\r\n  createFeature: function(obj) {\r\n    var wkt = new Wkt.Wkt();\r\n    wkt.read(obj);\r\n    var f = wkt.toObject();\r\n    return f;\r\n  },\r\n  createMarker: function(lat, lng, options) {\r\n    return L.marker(L.latLng(lat, lng), options);\r\n  },\r\n  addClusterMarker: function(marker) {\r\n    if (typeof this.clusterGroup == 'undefined')\r\n      return;\r\n    this.clusterGroup.addLayer(marker);\r\n  },\r\n  clearClusterMarkers: function() {\r\n    this.clusterGroup.clearLayers();\r\n  },\r\n  getClusterGroup: function(){\r\n    return this.clusterGroup;\r\n  },\r\n  getFeaturesBound: function() {\r\n    var features = this.features;\r\n    if (typeof features == 'undefined') {\r\n      console.log('No feature group found');\r\n      return;\r\n    }\r\n    return features.getBounds();\r\n  },\r\n  getGeoJsonFeaturesBound: function() {\r\n    var features = this.geoJsonFeatures;\r\n    if (typeof features == 'undefined') {\r\n      console.log('No geojson feature found');\r\n      return;\r\n    }\r\n    return features.getBounds();\r\n  },\r\n  zoomToFeatures: function() {\r\n    var bounds = this.getFeaturesBound();\r\n    if (typeof bounds != 'undefined')\r\n      this.map.fitBounds(bounds);\r\n  },\r\n  zoomToGeoJsonFeatures: function() {\r\n    var bounds = this.getGeoJsonFeaturesBound();\r\n    if (typeof bounds != 'undefined')\r\n      this.map.fitBounds(bounds);\r\n  },\r\n  zoomToPoint: function(point, zoom) {\r\n    var z = zoom || this.map.getMaxZoom(); //default zoom\r\n    if (typeof point.x != 'undefined' && typeof point.y != 'undefined') {\r\n      var latlng = new L.LatLng(point.y, point.x);\r\n      this.map.setView(latlng, z);\r\n    } else {\r\n      this.map.setView(point, z);\r\n    }\r\n  },\r\n  pointInPolygon: function(point, vs) {\r\n    // ray-casting algorithm based on\r\n    // http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\r\n\r\n    var x = point[0],\r\n      y = point[1];\r\n\r\n    var inside = false;\r\n    for (var i = 0, j = vs.length - 1; i < vs.length; j = i++) {\r\n      var xi = vs[i][0],\r\n        yi = vs[i][1];\r\n      var xj = vs[j][0],\r\n        yj = vs[j][1];\r\n\r\n      var intersect = ((yi > y) != (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\r\n      if (intersect) inside = !inside;\r\n    }\r\n\r\n    return inside;\r\n  }\r\n\r\n});\r\n\r\nmodule.exports = LeafletViewer;\n\n\n// WEBPACK FOOTER //\n// ./public/js/map/leafletViewer.js","/*\r\nTu Hoang\r\nESRGC\r\n2014\r\n\r\nclass.js\r\nutility functions that implements OOP\r\n*/\r\n\r\n/*\r\nfunction that defines a new class by passing a new\r\nprototype object (literal) as parameter. New classes\r\ncan extend/inherit from other classes by passing the \r\ninherit class name to extend property of the new class \r\nprototype object\r\n\r\nExample:\r\nvar newClass = dx.define({\r\nextend: OtherClass,\r\ninitialize: function(options){\r\n};\r\n});\r\n*/\r\nvar define = function(child) {\r\n  var ch = child;\r\n  var p = ch.extend;\r\n  var _class_ = null;\r\n  if (p == null || typeof p == 'undefined') {\r\n    _class_ = function() {\r\n      if (typeof this.initialize != 'undefined')\r\n        this.initialize.apply(this, arguments);\r\n    };\r\n    _class_.prototype = ch;\r\n  } else {\r\n    _class_ = function() {\r\n      var init = typeof this.initialize == 'function' ? this.initialize : 'undefined';\r\n      //run child initialize function if exists\r\n      if (typeof init == 'function') {\r\n        init.apply(this, arguments);\r\n      }\r\n    };\r\n    extend(_class_, p); //inherit prototype\r\n    copy(_class_.prototype, ch); //augment prototype\r\n  }\r\n  return _class_;\r\n};\r\n/*\r\nDeep copy object prototype by new keyword.\r\nThis method creates a new prototype object, whose prototype \r\nis a copy of the parent's prototype, and assign it to the child prototype.\r\nFinally, sets the child's prototype constructor to the child's constructor\r\n*/\r\nvar extend = function(child, parent) {\r\n  var F = function() {};\r\n  F.prototype = parent.prototype;\r\n  child.prototype = new F();\r\n  child.prototype.constructor = child;\r\n  child.parent = parent.prototype;\r\n};\r\n//copy object properties\r\nvar copy = function(dest, source) {\r\n  dest = dest || {};\r\n  if (source) {\r\n    for (var property in source) {\r\n      var value = source[property];\r\n      if (value !== undefined) {\r\n        dest[property] = value;\r\n      }\r\n    }\r\n    /**\r\n     * IE doesn't include the toString property when iterating over an object's\r\n     * properties with the for(property in object) syntax.  Explicitly check if\r\n     * the source has its own toString property.\r\n     */\r\n    /*\r\n     * FF/Windows < 2.0.0.13 reports \"Illegal operation on WrappedNative\r\n     * prototype object\" when calling hawOwnProperty if the source object\r\n     * is an instance of window.Event.\r\n     */\r\n\r\n    var sourceIsEvt = typeof window.Event == \"function\" && source instanceof window.Event;\r\n\r\n    if (!sourceIsEvt &&\r\n      source.hasOwnProperty && source.hasOwnProperty(\"toString\")) {\r\n      dest.toString = source.toString;\r\n    }\r\n  }\r\n  return dest;\r\n};\r\n\r\nmodule.exports = {\r\n  define: define,\r\n  extend: extend,\r\n  copy: copy\r\n};\n\n\n// WEBPACK FOOTER //\n// ./public/js/util/class.js","/*\r\nAuthor: Tu hoang\r\nESRGC\r\nProvides base (prototype) functions for mapviewer\r\n\r\nThis class implement leaflet API\r\n*/\r\n\r\nvar Class = require('../util/class');\r\n\r\nvar MapViewer = Class.define({\r\n    name: 'MapViewer',\r\n    _className: 'MapViewer',\r\n    initialize: function(options) {\r\n      Class.copy(this, options);//copy all options to this class\r\n    },\r\n    zoomToExtent: function(extent) {\r\n        this.map.fitBounds(new L.LatLngBounds(new L.LatLng(extent.xmin, extent.ymin),\r\n         new L.LatLng(extent.xmax, extent.ymax)));\r\n    },\r\n    zoomToFullExtent: function() {\r\n    },\r\n    //zoom to xy (if level exists then zoom to that level otherwise maxlevel is used)\r\n    zoomToXY: function(x, y, level) {\r\n        if (typeof level == 'undefined')\r\n            this.map.setView(new L.LatLng(y, x), this.map.getMaxZoom());\r\n        else\r\n            this.map.setView(new L.LatLng(y, x), level);\r\n    },\r\n    zoomIn: function() {\r\n        this.map.zoomIn();\r\n    },\r\n    zoomOut: function() {\r\n        this.map.zoomOut();\r\n    },\r\n    zoomToDataExtent: function(layer) {\r\n        this.map.fitBounds(layer.getBounds());\r\n    },\r\n    panTo: function(x, y) {\r\n        this.map.panTo(new L.LatLng(y, x));\r\n    },\r\n    locate: function() {\r\n        this.map.locateAndSetView(this.map.getMaxZoom() - 2);\r\n    }\r\n\r\n});\r\n\r\nmodule.exports = MapViewer;\n\n\n// WEBPACK FOOTER //\n// ./public/js/map/mapViewer.js","/*\r\nTu Hoang\r\nMarch 2017\r\n\r\nCalendar view\r\n\r\nevent callbacks: \r\nonEventClick(event, jsEvent, view)\r\nonEventsLoaded(eventData, view)\r\n\r\n*/\r\n\r\n\r\nvar Calendar = Backbone.View.extend({\r\n  name: 'CalendarView',\r\n  el: '#calendar-area',\r\n  render: function() {\r\n    var scope = this;\r\n    this.$('#calendar').fullCalendar({\r\n      //init full calendar \r\n      header: {\r\n        left: 'prev,next,today',\r\n        center: 'title',\r\n        right: 'month,agendaWeek,agendaDay,listMonth'\r\n      },\r\n      editable: false,\r\n      eventSources: [\r\n        //event feed\r\n        {\r\n          url: 'feed' // use the `url` property\r\n            // color: 'yellow', // an option!\r\n            // textColor: 'black' // an option!\r\n        }\r\n\r\n        // any other sources...\r\n\r\n      ],\r\n      eventLimit: true,\r\n      eventClick: (event, jsEvent, view) => {\r\n        console.log(event);\r\n        //register call back and trigger here\r\n        if (typeof scope.onEventClick == 'function')\r\n          scope.onEventClick.apply(scope, arguments);\r\n      },\r\n      loading: (isLoading, view) => {\r\n        if (!isLoading){\r\n          console.log('done fetching event data!');\r\n          var eventData = $('#calendar').fullCalendar('clientEvents');\r\n          // console.log(eventData);\r\n          if(typeof scope.onEventsLoaded == 'function'){\r\n          \tscope.onEventsLoaded.call(scope, eventData, view);\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    });\r\n  }\r\n});\r\n\r\nmodule.exports = Calendar;\r\n\n\n\n// WEBPACK FOOTER //\n// ./public/js/event/index/view/calendar.js","/*\r\nTu Hoang\r\nMarch 2017\r\n\r\nController class that handles map and calendar view \r\n\r\nES6 rocks\r\n*/\r\nvar MapView = require('../view/map.js');\r\nvar CalendarView = require('../view/calendar');\r\n\r\n\r\nclass mainController {\r\n  constructor() {\r\n    //views\r\n    this._mapView = new MapView();\r\n    this._calendarView = new CalendarView();\r\n  }\r\n  //initialize view components \r\n  initialize() {\r\n    console.log('Initializing...')\r\n      //render map\r\n    this._mapView.render();\r\n    //wire event callback for calendar\r\n    this._calendarView.onEventsLoaded = (eventData, view) => {\r\n      console.log(`this event is called from controller!`);\r\n      console.log(eventData);\r\n    };\r\n    //render calendar\r\n    this._calendarView.render();\r\n  }\r\n\r\n  get mapView() {\r\n    return this._mapView;\r\n  }\r\n\r\n  get calendarView() {\r\n    return this._calendarView;\r\n  }\r\n\r\n  zoomToLocation(x, y) {\r\n  \tthis._mapView.zoomToLocation(x, y);\r\n  }\r\n}\r\n\r\nmodule.exports = mainController;\r\n\n\n\n// WEBPACK FOOTER //\n// ./public/js/event/index/controller/main.js"],"sourceRoot":""}